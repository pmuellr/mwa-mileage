
//-----------------------------------------------------------------------------
// Copyright (c) 2010 Patrick Mueller
// Licensed under the MIT license: 
// http://www.opensource.org/licenses/mit-license.php
//-----------------------------------------------------------------------------

require underscore as _
require backbone

require ./util/BackboneLocalStorage
require ./util/Ex

require ./models/FillUp
require ./models/FillUpLog

require ./views/FillUpEditor
require ./views/FillUpRow
require ./util/StackTrace

//-----------------------------------------------------------------------------
class MileageApp

//-----------------------------------------------------------------------------
static 
    var Version   = "1.0.0"

//-----------------------------------------------------------------------------
static method main
    $(function() {
        MileageApp.$ = new MileageApp()
        MileageApp.$.runMain()
    })

//-----------------------------------------------------------------------------
static method showPage(id)
    $(".page").hide()
    $(id).show()
    StackTrace.dump()
    
//-----------------------------------------------------------------------------
method runMain
    this.getFillUps()
    this.setUpPages()
    
    MileageApp.showPage("#page-main")

//-----------------------------------------------------------------------------
method getFillUps
    this.fillUps = BackboneLocalStorage("FillUps")
    
//-----------------------------------------------------------------------------
method setUpPages
    this.setUpPageMain()
    this.setUpPageEdit()
    this.setUpPageSettings()
    this.setUpPageAbout()

//-----------------------------------------------------------------------------
method setUpPageMain
    var page = $("#page-main")
    $(".tool-add",      page).click(cbShowPageAdd)
    $(".tool-about",    page).click(cbShowPageAbout)
    $(".tool-settings", page).click(cbShowPageSettings)

//-----------------------------------------------------------------------------
method setUpPageEdit
    var page = $("#page-edit")
    $(".tool-save",      page).click(cbShowPageMain)
    $(".tool-cancel",    page).click(cbShowPageMain)

//-----------------------------------------------------------------------------
method setUpPageSettings
    var page = $("#page-settings")
    $(".tool-save",      page).click(cbShowPageMain)
    $(".tool-cancel",    page).click(cbShowPageMain)

//-----------------------------------------------------------------------------
method setUpPageAbout
    $("#version").html(Version)
    
    var page = $("#page-about")
    $(".tool-back",     page).click(cbShowPageMain)

//-----------------------------------------------------------------------------
function cbShowPageMain
    MileageApp.showPage("#page-main")

//-----------------------------------------------------------------------------
function cbShowPageAdd
    $("#edit-action").html("add")
    MileageApp.showPage("#page-edit")

//-----------------------------------------------------------------------------
function cbShowPageEdit
    $("#edit-action").html("edit")
    MileageApp.showPage("#page-edit")

//-----------------------------------------------------------------------------
function cbShowPageAbout
    MileageApp.showPage("#page-about")

//-----------------------------------------------------------------------------
function cbShowPageSettings
    MileageApp.showPage("#page-settings")
